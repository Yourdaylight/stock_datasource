# Aè‚¡èµ›åšæ“ç›˜æ‰‹ ğŸ¤–ğŸ“ˆ

**AI åŸç”Ÿçš„ A è‚¡æ™ºèƒ½æŠ•èµ„åŠ©æ‰‹** â€”â€” åŸºäºå¤§è¯­è¨€æ¨¡å‹å’Œ LangGraph å¤šæ™ºèƒ½ä½“æ¶æ„ï¼Œä¸ºä¸ªäººæŠ•èµ„è€…æä¾›ä¸“ä¸šçº§çš„è‚¡ç¥¨åˆ†æã€æ™ºèƒ½é€‰è‚¡ã€æŠ•èµ„ç»„åˆç®¡ç†å’Œç­–ç•¥å›æµ‹èƒ½åŠ›ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ§  AI åŸç”Ÿæ¶æ„

- **å¤šæ™ºèƒ½ä½“åä½œ**ï¼š8 ä¸ªä¸“ä¸š Agent åˆ†å·¥åä½œï¼Œè¦†ç›–æŠ•èµ„å…¨æµç¨‹
- **æ™ºèƒ½æ„å›¾è¯†åˆ«**ï¼šè‡ªåŠ¨ç†è§£ç”¨æˆ·æ„å›¾ï¼Œè·¯ç”±åˆ°æœ€åˆé€‚çš„ä¸“ä¸š Agent
- **è‡ªç„¶è¯­è¨€äº¤äº’**ï¼šç”¨è‡ªç„¶è¯­è¨€ä¸ç³»ç»Ÿå¯¹è¯ï¼Œæ— éœ€å­¦ä¹ å¤æ‚æ“ä½œ
- **æµå¼å“åº”**ï¼šå®æ—¶å±•ç¤º AI æ€è€ƒè¿‡ç¨‹ï¼Œä½“éªŒæ›´æµç•…
- **Langfuse å¯è§‚æµ‹**ï¼šå®Œæ•´çš„ AI è°ƒç”¨é“¾è·¯è¿½è¸ªå’Œåˆ†æ

### ğŸ¯ å…«å¤§ä¸“ä¸š Agent

| Agent | åŠŸèƒ½ | å…¸å‹åœºæ™¯ |
|-------|------|----------|
| **MarketAgent** | è¡Œæƒ…åˆ†æ | "åˆ†æè´µå·èŒ…å°çš„èµ°åŠ¿"ã€"600519 ä¼°å€¼å¦‚ä½•" |
| **ScreenerAgent** | æ™ºèƒ½é€‰è‚¡ | "æ‰¾å‡ºä½ä¼°å€¼é«˜æˆé•¿çš„è‚¡ç¥¨"ã€"ç­›é€‰è‚¡æ¯ç‡è¶…è¿‡5%çš„è‚¡ç¥¨" |
| **ReportAgent** | è´¢æŠ¥åˆ†æ | "åˆ†æå®å¾·æ—¶ä»£çš„è´¢åŠ¡çŠ¶å†µ"ã€"æ¯”è¾ƒèŒ…å°å’Œäº”ç²®æ¶²çš„è´¢æŠ¥" |
| **PortfolioAgent** | æŒä»“ç®¡ç† | "æŸ¥çœ‹æˆ‘çš„æŒä»“"ã€"åˆ†ææŠ•èµ„ç»„åˆé£é™©" |
| **BacktestAgent** | ç­–ç•¥å›æµ‹ | "å›æµ‹åŒå‡çº¿ç­–ç•¥"ã€"æµ‹è¯•è¿™ä¸ªé€‰è‚¡æ¡ä»¶çš„å†å²æ”¶ç›Š" |
| **MemoryAgent** | ç”¨æˆ·è®°å¿† | "è®°ä½æˆ‘çš„è‡ªé€‰è‚¡"ã€"æˆ‘çš„æŠ•èµ„åå¥½æ˜¯ä»€ä¹ˆ" |
| **DataManageAgent** | æ•°æ®ç®¡ç† | "æ›´æ–°ä»Šæ—¥æ•°æ®"ã€"æ£€æŸ¥æ•°æ®è´¨é‡" |
| **ChatAgent** | é€šç”¨å¯¹è¯ | å…¶ä»–æŠ•èµ„ç›¸å…³é—®é¢˜ |

### ğŸ“Š æ™ºèƒ½é€‰è‚¡ç³»ç»Ÿ

- **å®æ—¶è¡Œæƒ…å±•ç¤º**ï¼šåˆ†é¡µå±•ç¤ºå…¨å¸‚åœºè‚¡ç¥¨è¡Œæƒ…ï¼Œæ”¯æŒæ’åºå’Œæœç´¢
- **å¤šç»´åº¦ç­›é€‰**ï¼šPEã€PBã€å¸‚å€¼ã€æ¶¨è·Œå¹…ã€æ¢æ‰‹ç‡ç­‰å¤šæ¡ä»¶ç»„åˆ
- **AI è¾…åŠ©é€‰è‚¡**ï¼šè‡ªç„¶è¯­è¨€æè¿°é€‰è‚¡æ¡ä»¶ï¼ŒAI è‡ªåŠ¨ç”Ÿæˆç­›é€‰ç­–ç•¥
- **å¸‚åœºæ¦‚è§ˆ**ï¼šæ¶¨è·Œç»Ÿè®¡ã€æˆäº¤é¢åˆ†å¸ƒç­‰å¸‚åœºå…¨è²Œ

### ğŸ“ˆ ä¸“ä¸šè¡Œæƒ…åˆ†æ

- **K çº¿å›¾è¡¨**ï¼šäº¤äº’å¼ K çº¿å›¾ï¼Œæ”¯æŒå¤šç§æŠ€æœ¯æŒ‡æ ‡
- **è¶‹åŠ¿åˆ†æ**ï¼šå‡çº¿ç³»ç»Ÿã€MACDã€RSI ç­‰æŠ€æœ¯åˆ†æ
- **ä¼°å€¼åˆ†æ**ï¼šPEã€PBã€å¸‚å€¼ç­‰åŸºæœ¬é¢æŒ‡æ ‡
- **å¯¹æ¯”åˆ†æ**ï¼šå¤šè‚¡ç¥¨æ¨ªå‘å¯¹æ¯”

### ğŸ’¼ æŠ•èµ„ç»„åˆç®¡ç†

- **æŒä»“è·Ÿè¸ª**ï¼šå®æ—¶è®¡ç®—æŒä»“ç›ˆäº
- **é£é™©åˆ†æ**ï¼šç»„åˆæ³¢åŠ¨ç‡ã€æœ€å¤§å›æ’¤ç­‰é£é™©æŒ‡æ ‡
- **æ”¶ç›Šå½’å› **ï¼šåˆ†ææ”¶ç›Šæ¥æº
- **äº¤æ˜“è®°å½•**ï¼šå®Œæ•´çš„ä¹°å–è®°å½•ç®¡ç†

### ğŸ”„ ç­–ç•¥å›æµ‹

- **å¯è§†åŒ–å›æµ‹**ï¼šå›¾è¡¨å±•ç¤ºç­–ç•¥è¡¨ç°
- **å¤šç­–ç•¥æ”¯æŒ**ï¼šå‡çº¿ã€åŠ¨é‡ã€ä»·å€¼ç­‰å¤šç§ç­–ç•¥æ¨¡æ¿
- **è¯¦ç»†æŠ¥å‘Š**ï¼šæ”¶ç›Šç‡ã€å¤æ™®æ¯”ç‡ã€æœ€å¤§å›æ’¤ç­‰å…³é”®æŒ‡æ ‡
- **å‚æ•°ä¼˜åŒ–**ï¼šè‡ªåŠ¨å¯»æ‰¾æœ€ä¼˜ç­–ç•¥å‚æ•°

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd stock_datasource

# å®‰è£…ä¾èµ–
uv sync

# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š
```env
# å¿…éœ€ï¼šTuShare API Token
TUSHARE_TOKEN=your_token_here

# å¿…éœ€ï¼šOpenAI API é…ç½®ï¼ˆAI åŠŸèƒ½ï¼‰
OPENAI_API_KEY=your_api_key_here
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_MODEL=gpt-4

# ClickHouse é…ç½®
CLICKHOUSE_HOST=localhost
CLICKHOUSE_PORT=9000
CLICKHOUSE_DATABASE=stock_datasource
```

### 2. åˆå§‹åŒ–æ•°æ®åº“

```bash
uv run cli.py init-db
```

### 3. é‡‡é›†æ•°æ®

```bash
# åŠ è½½è‚¡ç¥¨åŸºç¡€ä¿¡æ¯
uv run cli.py load-stock-basic

# åŠ è½½äº¤æ˜“æ—¥å†
uv run cli.py load-trade-calendar --start-date 20250101 --end-date 20251231

# é‡‡é›†æ—¥çº¿æ•°æ®
uv run cli.py ingest-daily --date 20251024
```

### 4. å¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨åç«¯ API æœåŠ¡
uv run python -m stock_datasource.services.http_server

# å¯åŠ¨å‰ç«¯ï¼ˆæ–°ç»ˆç«¯ï¼‰
cd frontend && npm install && npm run dev
```

è®¿é—® http://localhost:5173 å¼€å§‹ä½¿ç”¨ï¼

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         å‰ç«¯ (Vue 3 + TypeScript)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ æ™ºèƒ½å¯¹è¯ â”‚ â”‚ æ™ºèƒ½é€‰è‚¡ â”‚ â”‚ è¡Œæƒ…åˆ†æ â”‚ â”‚ æŒä»“ç®¡ç† â”‚ â”‚ ç­–ç•¥å›æµ‹ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚          â”‚          â”‚          â”‚          â”‚
        â–¼          â–¼          â–¼          â–¼          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      API Layer (FastAPI)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                  OrchestratorAgent                        â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚    â”‚           æ„å›¾è¯†åˆ« & è·¯ç”±åˆ†å‘                   â”‚      â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â”‚         â”‚         â”‚         â”‚         â”‚         â”‚         â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚    â”‚ Market â”‚ â”‚Screenerâ”‚ â”‚Reportâ”‚ â”‚Portfoâ”‚ â”‚Backtestâ”‚   â”‚   â”‚
â”‚  â”‚    â”‚ Agent  â”‚ â”‚ Agent  â”‚ â”‚Agent â”‚ â”‚Agent â”‚ â”‚ Agent  â”‚   â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                                    â”‚
        â–¼                                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   LLM (OpenAI)    â”‚                          â”‚  ClickHouse DB    â”‚
â”‚   GPT-4 / GPT-4o  â”‚                          â”‚  Aè‚¡å…¨é‡æ•°æ®       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆ

**åç«¯**
- Python 3.11+ / FastAPI / LangGraph
- ClickHouse (é«˜æ€§èƒ½åˆ—å¼æ•°æ®åº“)
- TuShare (Aè‚¡æ•°æ®æº)
- Langfuse (AI å¯è§‚æµ‹æ€§)

**å‰ç«¯**
- Vue 3 + TypeScript
- TDesign ç»„ä»¶åº“
- ECharts (Kçº¿å›¾è¡¨)
- Pinia (çŠ¶æ€ç®¡ç†)

**AI**
- LangGraph (å¤šæ™ºèƒ½ä½“æ¡†æ¶)
- OpenAI GPT-4 / GPT-4o
- Function Calling (å·¥å…·è°ƒç”¨)

## ğŸ“ é¡¹ç›®ç»“æ„

```
stock_datasource/
â”œâ”€â”€ src/stock_datasource/
â”‚   â”œâ”€â”€ agents/              # AI Agent å±‚
â”‚   â”‚   â”œâ”€â”€ orchestrator.py  # ç¼–æ’å™¨
â”‚   â”‚   â”œâ”€â”€ market_agent.py  # è¡Œæƒ…åˆ†æ
â”‚   â”‚   â”œâ”€â”€ screener_agent.py # æ™ºèƒ½é€‰è‚¡
â”‚   â”‚   â”œâ”€â”€ report_agent.py  # è´¢æŠ¥åˆ†æ
â”‚   â”‚   â”œâ”€â”€ portfolio_agent.py # æŒä»“ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ backtest_agent.py # ç­–ç•¥å›æµ‹
â”‚   â”‚   â”œâ”€â”€ memory_agent.py  # ç”¨æˆ·è®°å¿†
â”‚   â”‚   â””â”€â”€ tools.py         # Agent å·¥å…·é›†
â”‚   â”œâ”€â”€ plugins/             # æ•°æ®é‡‡é›†æ’ä»¶
â”‚   â”œâ”€â”€ services/            # HTTP/MCP æœåŠ¡
â”‚   â”œâ”€â”€ modules/             # åŠŸèƒ½æ¨¡å—
â”‚   â””â”€â”€ core/                # æ ¸å¿ƒç»„ä»¶
â”œâ”€â”€ frontend/                # Vue å‰ç«¯
â”œâ”€â”€ docs/                    # æ–‡æ¡£
â”œâ”€â”€ cli.py                   # å‘½ä»¤è¡Œå·¥å…·
â””â”€â”€ tests/                   # æµ‹è¯•
```

## ğŸ”Œ MCP Server æ”¯æŒ

ç³»ç»Ÿæä¾› MCP (Model Context Protocol) Serverï¼Œå¯é›†æˆåˆ° Claude Codeã€Cursor ç­‰ AI IDEï¼š

```json
{
  "mcpServers": {
    "stock_datasource": {
      "url": "http://localhost:8001/messages",
      "transport": "streamable-http"
    }
  }
}
```

å¯åŠ¨ MCP Serverï¼š
```bash
uv run python -m stock_datasource.services.mcp_server
```

## ğŸ“š æ–‡æ¡£

| æ–‡æ¡£ | è¯´æ˜ |
|------|------|
| [CLI ä½¿ç”¨æŒ‡å—](docs/CLI_GUIDE.md) | å‘½ä»¤è¡Œå·¥å…·è¯¦ç»†ä½¿ç”¨è¯´æ˜ |
| [å¼€å‘æŒ‡å—](DEVELOPMENT_GUIDE.md) | å¼€å‘è€…æ–‡æ¡£ |
| [æ’ä»¶å¼€å‘](PLUGIN_QUICK_START.md) | æ–°å»ºæ•°æ®æ’ä»¶å¿«é€Ÿå‚è€ƒ |

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
uv run pytest tests/

# æµ‹è¯• AI Agent
uv run python -c "
from dotenv import load_dotenv; load_dotenv()
from stock_datasource.agents import get_orchestrator
import asyncio

async def test():
    orch = get_orchestrator()
    result = await orch.execute('åˆ†æè´µå·èŒ…å°')
    print(result.response)

asyncio.run(test())
"
```

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request
